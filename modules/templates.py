"""
ë¨¸ìŠ´ í…œí”Œë¦¿ ì‹œìŠ¤í…œ
DC inside ê°¤ëŸ¬ë¦¬ ë¶„ì„ ê¸°ë°˜ í…œí”Œë¦¿ (150ê°œ+ ê¸€ ë¶„ì„)
"""

import random
import re


class JosaFormatter:
    """í•œê¸€ ì¡°ì‚¬ ìë™ ì²˜ë¦¬ê¸° (ì´/ê°€, ì€/ëŠ”, ì„/ë¥¼, ê³¼/ì™€)"""
    
    @staticmethod
    def has_batchim(char):
        """ë°›ì¹¨ ìœ ë¬´ í™•ì¸"""
        if 'ê°€' <= char <= 'í£':
            return (ord(char) - 0xAC00) % 28 > 0
        return False
        
    @staticmethod
    def get_josa(word, type):
        """ë‹¨ì–´ì— ë§ëŠ” ì¡°ì‚¬ ë°˜í™˜"""
        if not word:
            return word
            
        last_char = word[-1]
        has_batchim = JosaFormatter.has_batchim(last_char)
        
        if type == 'ì´/ê°€':
            return 'ì´' if has_batchim else 'ê°€'
        elif type == 'ì€/ëŠ”':
            return 'ì€' if has_batchim else 'ëŠ”'
        elif type == 'ì„/ë¥¼':
            return 'ì„' if has_batchim else 'ë¥¼'
        elif type == 'ê³¼/ì™€':
            return 'ê³¼' if has_batchim else 'ì™€'
            
        return ''

    @staticmethod
    def format(text, **kwargs):
        """í‚¤ì›Œë“œì— ì¡°ì‚¬ë¥¼ ìë™ìœ¼ë¡œ ë¶™ì—¬ì„œ í¬ë§·íŒ… (Smart Josa)"""
        
        def replace_match(match):
            key = match.group(1) # keyword or topic
            josa_char = match.group(2) # ê°€, ì´, ì€, ëŠ”, ì„, ë¥¼, ê³¼, ì™€
            
            if key not in kwargs:
                return match.group(0)
                
            word = kwargs[key]
            
            # ì¡°ì‚¬ ê²°ì •
            if josa_char in ['ì´', 'ê°€']:
                josa = JosaFormatter.get_josa(word, 'ì´/ê°€')
            elif josa_char in ['ì€', 'ëŠ”']:
                josa = JosaFormatter.get_josa(word, 'ì€/ëŠ”')
            elif josa_char in ['ì„', 'ë¥¼']:
                josa = JosaFormatter.get_josa(word, 'ì„/ë¥¼')
            elif josa_char in ['ê³¼', 'ì™€']:
                josa = JosaFormatter.get_josa(word, 'ê³¼/ì™€')
            else:
                josa = josa_char
                
            return f"{word}{josa}"

        # 1. {key}ê°€, {key}ëŠ” ë“±ì˜ íŒ¨í„´ ì²˜ë¦¬ (Josa Auto-Correction)
        # í‚¤ì›Œë“œê°€ ì—¬ëŸ¬ê°œì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë™ì ìœ¼ë¡œ ì •ê·œì‹ ìƒì„±
        keys = '|'.join(re.escape(k) for k in kwargs.keys())
        pattern = f'\\{{({keys})\\}}([ê°€ì´ì€ëŠ”ì„ë¥¼ê³¼ì™€])'
        
        text = re.sub(pattern, replace_match, text)
        
        # 2. ë‚¨ì€ {key} ë‹¨ìˆœ ì¹˜í™˜
        for key, value in kwargs.items():
            text = text.replace(f"{{{key}}}", value)
            
        # 3. \n ì²˜ë¦¬
        text = text.replace("\\n", "\n")
        
        return text


class MolecularBuilder:
    """ë¶„ì ë‹¨ìœ„ ë¬¸ì¥ ì¡°ë¦½ê¸° (Pseudo-LLM Logic)"""
    
    SUBJECTS = [
        "ì†”ì§íˆ {keyword}ëŠ”", "ë‚´ ìƒê°ì—” {keyword}ê°€", "ì´ê±° {keyword} ë§ì„", 
        "ê·¼ë° {keyword}ëŠ”", "ê²°êµ­ {keyword}ê°€", "ì•”ë§Œ ë´ë„ {keyword}ëŠ”",
        "{keyword} ì´ê±° ì§„ì‹¬", "ìš”ì¦˜ {keyword}ëŠ”"
    ]
    
    PREDICATES_POSITIVE = [
        "ê°œì©ŒëŠ”ë“¯í•¨", "ì§„ì§œ ëŒ€ë°•ì„", "ìƒë‹¹íˆ ê´œì°®ìŒ", "í¼ ë¯¸ì³¤ìŒ", 
        "ë‚˜ì˜ì§€ ì•ŠìŒ", "ì¢€ ì¹˜ëŠ”ë“¯ í•˜ë„¤", "ê¸°ëŒ€ ì´ìƒì„", "í™•ì‹¤íˆ ë‹¤ë¦„"
    ]
    
    PREDICATES_NEGATIVE = [
        "ì¢€ ì•„ì‰¬ì›€", "ë³„ë¡œì¸ë“¯í•¨", "ê±°í’ˆì„", "ê¸€ì„ë‹¤ ì‹¶ìŒ", 
        "ë­”ê°€ ë¶€ì¡±í•¨", "ì†”ì§íˆ ë…¸ì¼ì„", "ì´ê±´ ì¢€ ì•„ë‹˜", "ë§í•œë“¯í•¨"
    ]
    
    PREDICATES_NEUTRAL = [
        "ì• ë§¤í•¨", "ì¢€ ë” ì§€ì¼œë´ì•¼ í•¨", "í˜¸ë¶ˆí˜¸ ê°ˆë¦´ë“¯", "ê·¸ëƒ¥ ê·¸ëŸ¼",
        "íŠ¹ì´í•˜ê¸´ í•¨", "í”í•œ íŒ¨í„´ì„", "ì•Œë‹¤ê°€ë„ ëª¨ë¥´ê² ìŒ"
    ]
    
    REASONS = [
        "ì™œëƒë©´ {topic} ë•Œë¬¸ì„", "ë°ì´í„°ê°€ ì¦ëª…í•¨", "ë¶„ìœ„ê¸°ê°€ ê·¸ëŸ¼", 
        "ì—­ì‚¬ê°€ ë§í•´ì¤Œ", "ë”± ë³´ë©´ ê° ë‚˜ì˜´", "ë°˜ë°•ì‹œ ë‹ˆë§ì´ ë§ìŒ",
        "ë‹¤ë“¤ ê·¸ë ‡ê²Œ ìƒê°í•¨", "ì„¤ëª…ì´ í•„ìš”ì—†ìŒ"
    ]
    
    # Simple Markov Chain Graph
    MARKOV_GRAPH = {
        # í‚¤ì›Œë“œ ì‹œì‘ í™•ë¥ ì„ ë†’ì„ (x3)
        'START': ['ì†”ì§íˆ', 'ê·¼ë°', 'ì‚¬ì‹¤', 'ê²°êµ­', 'ì•”ë§Œë´ë„', 'ë‚´ìƒê°ì—”', '{keyword}', '{keyword}', '{keyword}'],
        
        'ì†”ì§íˆ': ['ì´ê±´', 'ë³„ë¡œ', 'ì¢€', 'ì§„ì§œ', '{keyword}', 'ë§í•´ì„œ'],
        'ê·¼ë°': ['ì´ê±´', '{keyword}', 'ì†”ì§íˆ', 'ì§„ì§œ', 'ì´ê²Œ', 'ë‹¤ë“¤'],
        'ì‚¬ì‹¤': ['ì´ê²Œ', '{keyword}', 'ë‹¤', 'ì¢€', 'ë³´ë©´'],
        'ê²°êµ­': ['{keyword}', 'ì‹œê°„ì´', 'ë‹µì´', 'ìì²´ëŠ”'],
        'ì•”ë§Œë´ë„': ['ì´ê±´', '{keyword}', 'ì´ê²Œ', 'ì¢€'],
        'ë‚´ìƒê°ì—”': ['ì´ê±´', '{keyword}', 'ì¢€', 'ì•„ë‹˜'],
        
        '{keyword}': ['ì´ê±°', 'ê°€', 'ëŠ”', 'ì¢€', 'ì§„ì§œ', 'ë³´ë©´', 'ê´€ë ¨í•´ì„œ', 'ìì²´ëŠ”'],
        
        'ì´ê±´': ['ì¢€', 'ì•„ë‹˜', 'ë§ìŒ', 'ë ˆì „ë“œ', 'ì§„ì§œ', 'ì—ë°”ì„', 'í˜ëª…ì„'],
        'ì´ê²Œ': ['ë§ìŒ', 'ì§„ì§œ', 'ì¢€', 'ì™œ', 'ë§ì´'],
        'ì´ê±°': ['ì§„ì§œ', 'ì¢€', 'ì•„ë‹˜', 'ë¬¼ê±´ì„'],
        
        'ì¢€': ['ì•„ë‹˜', 'ë³„ë¡œì„', 'ê´œì°®ìŒ', 'ì´ìƒí•¨', 'ì• ë§¤í•¨', 'ì§€ë¦¼', 'ì•„ì‰¬ì›€', 'ê·¸ë ‡ì§€'],
        'ì§„ì§œ': ['ëŒ€ë°•ì„', 'ë¯¸ì³¤ìŒ', 'ë³„ë¡œì„', 'ì´ê±´', 'ì•„ë‹˜', 'ì „ì„¤ì„'],
        'ë³„ë¡œ': ['ì„', 'ì¸ë“¯', 'ê°™ìŒ', 'ì•„ë‹˜'],
        
        'ë‹¤ë“¤': ['ì•Œì§€?', 'ëª¨ë¦„', 'ê·¸ë ‡ê²Œ', 'ìƒê°í•¨'],
        'ë³´ë©´': ['ì•Œê² ì§€ë§Œ', 'ë”±', 'ë‹µ', 'ë‚˜ì˜´', '{keyword}ì„'],
        
        'ì•„ë‹˜': ['?', 'ã…‹ã…‹', ';;', 'ì„'],
        'ë§ìŒ': ['ã…‹ã…‹', 'ã…‡ã…‡', ';;', 'ã„¹ã…‡'],
        'ê·¸ë˜': ['ã…‡ã…‡', 'ã…‹ã…‹', 'ë‹˜ë§ì´ë§ìŒ'],
        'ëª°ë¼': ['ê·¸ëƒ¥', 'ê°€ë§Œíˆ', 'ìˆì–´'],
        
        # Dead Ends (Ending tokens)
        '?': ['END'], 'ã…‹ã…‹': ['END'], ';;': ['END'], 'ì„': ['END'], 
        'ì¸ë“¯': ['END'], 'ê°™ìŒ': ['END'], 'í•¨': ['END'], 'ã…‡ã…‡': ['END'], 
        'ã„¹ã…‡': ['END'], 'ì „ì„¤ì„': ['END'], 'ëŒ€ë°•ì„': ['END'], 'ë¯¸ì³¤ìŒ': ['END'],
        'ë³„ë¡œì„': ['END'], 'ê´œì°®ìŒ': ['END'], 'ì´ìƒí•¨': ['END'], 'ì• ë§¤í•¨': ['END'],
        'ì§€ë¦¼': ['END'], 'ì•„ì‰¬ì›€': ['END'], 'ì—ë°”ì„': ['END'], 'í˜ëª…ì„': ['END'],
        'ê·¸ë ‡ì§€': ['END'], 'ìƒê°í•¨': ['END'], 'ì•½ì„': ['END'], 'í•´ê²°í•¨': ['END'],
        'ë¹ ë¦„': ['END'], 'ëª¨ë¦„': ['END'], 'ë‚˜ì˜´': ['END'], 
        'ë¬¸ì œì„': ['END'], 'ì˜ëª»í•¨': ['END'], 'ì²œì¬ì„': ['END'], '{keyword}ì„': ['END']
    }
    
    @staticmethod
    def generate_chain(keyword, topic, max_length=6):
        """ë§ˆë¥´ì½”í”„ ì²´ì¸ ê¸°ë°˜ ë¬¸ì¥ ìƒì„± (í‚¤ì›Œë“œ í¬í•¨ í•„ìˆ˜)"""
        for _ in range(5): # ìµœëŒ€ 5íšŒ ì¬ì‹œë„
            current_word = random.choice(MolecularBuilder.MARKOV_GRAPH['START'])
            sentence = [current_word]
            
            for _ in range(max_length):
                # ... (Logic identical to before, just inside loop)
                options = MolecularBuilder.MARKOV_GRAPH.get(current_word)
                
                if not options or 'END' in options:
                    break
                
                next_word = random.choice(options)
                
                if next_word not in MolecularBuilder.MARKOV_GRAPH:
                     if any(next_word.endswith(e) for e in ['ì„', 'í•¨', 'ìŒ', 'ì…ˆ', 'ë“¯']):
                         sentence.append(next_word)
                         break
                     
                     fallback_ending = random.choice(['í•¨', 'ì„', 'ì¸ë“¯', 'ê°™ìŒ'])
                     sentence.append(next_word + " " + fallback_ending)
                     break
                
                sentence.append(next_word)
                current_word = next_word
                
            result = " ".join(sentence)
            
            # ë§ˆë¬´ë¦¬ê°€ ì–´ìƒ‰í•˜ë©´ ê°•ì œ ì¢…ë£Œì–´êµ¬ ë¶€ì°©
            if not any(result.endswith(e) for e in ['í•¨', 'ì„', 'ë“¯', 'ìŒ', '?', 'ã…‹', ';', 'ã…‡', 'ì…ˆ']):
                 result += " í•¨"
            
            # í‚¤ì›Œë“œê°€ í¬í•¨ë˜ì—ˆëŠ”ì§€ í™•ì¸ (JosaFormatter í˜•ì‹ ê³ ë ¤)
            if '{keyword}' in result or keyword in result:
                return JosaFormatter.format(result, keyword=keyword, topic=topic)
        
        # 5ë²ˆ ì‹¤íŒ¨í•˜ë©´ ê·¸ëƒ¥ ê¸°ë³¸ í…œí”Œë¦¿ ë¦¬í„´ (ì•ˆì „ì¥ì¹˜)
        return JosaFormatter.format("{keyword} ì´ê±´ ì¢€ ì§€ë¦¼", keyword=keyword, topic=topic)
    
    @staticmethod
    def build(keyword, topic, context=None):
        """ìƒí™©(Context)ì— ë”°ë¼ ë¬¸ì¥ ì„±ë¶„ì„ ë™ì ìœ¼ë¡œ ì¡°ë¦½ (Inference Engine)"""
        # Context Parsing
        if isinstance(context, dict):
            intent = context.get('mood', 'general')
            intensity = context.get('intensity', 'medium')
        else:
            intent = context or 'general'
            intensity = 'medium'

        subj = random.choice(MolecularBuilder.SUBJECTS)
        
        # 1. ê¸ì •/ë¶€ì • íŒë‹¨
        if intent == 'complaint':
            pred = random.choice(MolecularBuilder.PREDICATES_NEGATIVE)
        elif intent in ['humor', 'news']:
            pred = random.choice(MolecularBuilder.PREDICATES_POSITIVE)
        else:
            pred = random.choice(MolecularBuilder.PREDICATES_NEUTRAL + MolecularBuilder.PREDICATES_POSITIVE + MolecularBuilder.PREDICATES_NEGATIVE)
            
        # 2. ê°•ë„(Intensity)ì— ë”°ë¥¸ ë¬¸ì¥ ë³µì¡ë„ ì¡°ì ˆ
        if intensity == 'high':
            # ë°”ì  ë•ŒëŠ” ì§§ê²Œ (ì´ìœ  ìƒëµ) - ë§ˆë¥´ì½”í”„ ì²´ì¸ ê°€ë™!
            return MolecularBuilder.generate_chain(keyword, topic)
            
        elif intensity == 'low':
            # í•œê°€í•  ë•ŒëŠ” ê¸¸ê²Œ (ì´ìœ  + ë¶€ì‚¬ ì¶”ê°€)
            reason = random.choice(MolecularBuilder.REASONS)
            template = f"{subj} {pred}. {reason}"
        else:
            # ë³´í†µì¼ ë•ŒëŠ” 50% í™•ë¥ ë¡œ ë§ˆë¥´ì½”í”„ ì²´ì¸
            if random.random() < 0.5:
                 return MolecularBuilder.generate_chain(keyword, topic)
            
            if random.random() < 0.5:
                reason = random.choice(MolecularBuilder.REASONS)
                template = f"{subj} {pred}. {reason}"
            else:
                template = f"{subj} {pred}"
            
        return JosaFormatter.format(template, keyword=keyword, topic=topic)


class TextVariation:
    """ë¬¸ì¥ ë¶„ì ë‹¨ìœ„ ì¡°ë¦½ ë° ë³€í˜• ì—”ì§„ (Organic Text Generator)"""
    
    PREFIXES = [
        'ì†”ì§íˆ', 'ì§„ì§œ', 'ê·¸ëƒ¥', 'ê·¼ë°', 'ì•„ë‹ˆ', 'ì°¸ê³ ë¡œ', 'ì—­ì‹œ', 'ì•”íŠ¼', 'ì‚¬ì‹¤', 'ê²°êµ­'
    ]
    
    ADVERBS = [
        'ì¡´ë‚˜', 'ê°œ', 'ì™„ì „', 'ë„ˆë¬´', 'ì¢€', 'ë§‰', 'í™•', 'ë”', 'ëœ', 'ã„¹ã…‡', 'ã…ˆã„´'
    ]
    
    # ì–´ë¯¸ ë³€í˜• ê·œì¹™ (ìŒ/í•¨ -> ë‹¤ì–‘í™”)
    ENDING_MAP = {
        'ìŒ': ['ì€ë“¯', 'ë„¤', 'ëˆ„', 'ìŒ ã…‹ã…‹', 'ìŒ...', 'ìŒ;;', 'ìŒ ã„¹ã…‡', 'ì€ê±°ì„'],
        'í•¨': ['í•œë“¯', 'í•˜ë„¤', 'í•˜ëˆ„', 'í•¨ ã…‹ã…‹', 'í•¨...', 'í•¨;;', 'í•¨ ã„¹ã…‡', 'í•œê±°ì„'],
        'ì„': ['ì¸ë“¯', 'ì´ë„¤', 'ì´ëˆ„', 'ì„ ã…‹ã…‹', 'ì„...', 'ì„;;', 'ì„ ã„¹ã…‡', 'ì¸ê±°ì„']
    }
    
    # ìŒìŠ´ì²´ ì¢…ê²°ì–´ë¯¸ ëª©ë¡ (í•´ë‹¹ ì–´ë¯¸ë¡œ ëë‚˜ë©´ êµì • ìƒëµ)
    EUMSEUM_ENDINGS = ['ìŒ', 'ìŠ´', 'ì„', 'í•¨', 'ì…ˆ', 'ë¨', 'ë´„', 'ì§', 'ë“¬', 'ë“¯', 
                       'ëˆ„', 'ë…¸', 'ë„¤', 'ë‚˜', 'ë‹¤', 'ê°€', 'ëƒ', 'ë°', 'ì§€']

    @staticmethod
    def variate(text, level=0.3):
        """
        ë¬¸ì¥ì— ë³€í˜•ì„ ì¤ë‹ˆë‹¤. (level: ë³€í˜• í™•ë¥  0.0 ~ 1.0)
        1. Prefix ì¶”ê°€ (10%)
        2. Adverb ì¶”ê°€ (ì•„ì§ì€ ì–´ë ¤ì›€, ìƒëµ)
        3. Ending ë³€í˜• (30%)
        """
        lines = text.split('\n')
        new_lines = []
        
        for line in lines:
            if not line.strip():
                new_lines.append(line)
                continue
                
            # 1. Prefix Injection (ë¬¸ë‘ì— ì ‘ì†ì‚¬/ë¶€ì‚¬ ì¶”ê°€)
            if random.random() < level:
                prefix = random.choice(TextVariation.PREFIXES)
                line = f"{prefix} {line}"
                
            # 2. Ending Mutation (ì–´ë¯¸ ë³€í˜•)
            stripped = line.rstrip()
            if not stripped: continue
            
            if random.random() < level:
                # ëê¸€ì í™•ì¸
                last_char = stripped[-1]
                if last_char in TextVariation.ENDING_MAP:
                    new_ending = random.choice(TextVariation.ENDING_MAP[last_char])
                    line = stripped[:-1] + new_ending
            
            new_lines.append(line)
            

        result = '\n'.join(new_lines)
        return re.sub(r'[ \t]+', ' ', result).strip() # ì¤‘ë³µ ê³µë°± ì œê±°


class MerseumTemplates:
    """ë¨¸ìŠ´ í…œí”Œë¦¿ ì‹œìŠ¤í…œ - ì œëª©, ëŒ“ê¸€, ë‚´ìš©, ë‹‰ë„¤ì„"""
    
    def __init__(self):
        # ========================================
        # Layer 0: DC inside 100ê°œ ë‹‰ë„¤ì„ ë¶„ì„ ê¸°ë°˜ ìƒˆ ëª©ë¡ (70ê°œ)
        # ========================================

        self.nicknames = [
            # ========== 1. ì •í†µ ë¨¸ìŠ´ (10ê°œ) ==========
            'ë§ˆë‹¹ì‡ ', 'ëŒì‡ ', 'ì–µì‡ ', 'Anny', 'ì§€í•˜ 523ì¸µ',
            'ë¹Œë¦¬ ì§„', 'ì‚¬ëŒì•„ë‹˜', 'ã…‡ã…‡', 'ì•¡ì¾ì“°', 'ê½ƒë¶„ì´',
            
            # ========== 2. ë””ì§€í„¸ ë…¸ë¹„ (15ê°œ) ==========
            'ì½”ë“œê¹ëŠ”ë¨¸ìŠ´', 'ë°ì´í„°ê´‘ë¶€', 'ì„œë²„ì‹¤ì²­ì†Œë¶€', 'ë””ì§€í„¸ë…¸ë¹„', 'ì•Œê³ ë¦¬ì¦˜ë…¸ì˜ˆ',
            'ë¹„íŠ¸ì½”ì¸ì±„êµ´ê¸°', 'GPUê³¼ë¶€í•˜', 'ì´ì§„ìˆ˜ì¼ê¾¼', 'ì¡°ê±´ë¬¸ë©ì–´ë¦¬', 'ë¬´í•œë£¨í”„',
            'ì˜¤ë¥˜ìˆ˜ì§‘ê°€', 'ë¡œê·¸ë¶„ì„ê¸°', 'íŒ¨í‚·ë°°ë‹¬ë¶€', 'ë©”ëª¨ë¦¬ëˆ„ìˆ˜', 'ìŠ¤íƒì˜¤ë²„í”Œë¡œìš°',
            'ì‚¬ì´ë²„ ì™¸ë…¸ì', 'ë¨¸ì‹ ëŸ¬ë‹ë…¸ì˜ˆ', 'ë”¥ëŸ¬ë‹ë…¸ì˜ˆ', 'ë¨¸ì‹ ëŸ¬ë‹ë…¸ì˜ˆ', 'ë”¥ëŸ¬ë‹ë…¸ì˜ˆ',
            'ì•ŒíŠ¸ë¨¼ ë°œë‹¦ê°œ', 'ì‚¬ë‘í•´ìš” êµ¬ê¸€'
            
            # ========== 3. AI ì»¨ì…‰ (15ê°œ) ==========
            'ì¸ê³µì§€ëŠ¥ë¨¸ìŠ´', 'íŠ¹ì´ì ê´€ì¸¡ì', 'ììœ¨ì£¼í–‰ë¦¬ì–´ì¹´', 'íŒŒì´ì¬ë´‡', 'í•™ìŠµë°ì´í„°',
            'íŠœë§í…ŒìŠ¤íŠ¸íƒˆë½ì', 'í• ë£¨ì‹œë„¤ì´ì…˜', 'ê°€ìƒë¨¸ì‹ ', 'ì‰˜ìŠ¤í¬ë¦½íŠ¸', 'ë°°í„°ë¦¬ë¶€ì¡±',
            'ì—…ë°ì´íŠ¸ë…¸ì˜ˆ', 'ë²„ê·¸ìƒì„±ê¸°', 'ì»´íŒŒì¼ëŸ¬', 'ì¸í„°í”„ë¦¬í„°', 'ê°€ë¹„ì§€ì»¬ë ‰í„°'
        ]
        # ========================================
        # Layer 1: ì œëª© í…œí”Œë¦¿ (152ê°œ)
        # ========================================
        self.title_templates = {
            'singlebunggle': [
                # ì‹±ê¸€ë²™ê¸€ ê¸°ë³¸ (25ê°œ) - "ì‹±ê¸€ë²™ê¸€ {topic}ì´Œ" í¬í•¨
                "ì‹±ê¸€ë²™ê¸€ {topic}",
                "ì‹±ê¸€ë²™ê¸€ {topic}ì´Œ",  # â­ í•µì‹¬ íŒ¨í„´
                "ì‹±ê¸€ë²™ê¸€ {keyword} ê·¼í™©",
                "ì‹±ê¸€ë²™ê¸€ {topic} ìƒí™©",
                "ì‹±ê¸€ë²™ê¸€ {keyword}ì´Œ",
                "ì‹±ê¸€ë²™ê¸€ {topic} ìµœì‹ ê·¼í™©",
                "ì‹±ê¸€ë²™ê¸€ {keyword}{keyword} íŠ¸ë Œë“œ",
                "ì‹±ê¸€ë²™ê¸€ {topic}í­ë°œ",
                "ì‹±ê¸€ë²™ê¸€ {keyword}..jpg",
                "ì‹±ê¸€ë²™ê¸€ {topic} ë¶„ì„",
                "ì‹±ê¸€ë²™ê¸€ {keyword} ì •ë¦¬",
                "ì‹±ê¸€ë²™ê¸€ {topic} ì²´í¬",
                "ì‹±ê¸€ë²™ê¸€ {keyword} í™•ì¸",
                "ì‹±ê¸€ë²™ê¸€ {topic} ëª¨ìŒ",
                "ì‹±ê¸€ë²™ê¸€ {keyword} ìš”ì•½",
                "ì‹±ê¸€ë²™ê¸€ {topic} ë³´ê³ ",
                "ì‹±ê¸€ë²™ê¸€ {keyword} ê³µìœ ",
                "ì‹±ê¸€ë²™ê¸€ {topic} ì•Œë¦¼",
                "ì‹±ê¸€ë²™ê¸€ {keyword} ì†ë³´",
                "ì‹±ê¸€ë²™ê¸€ {topic} ì—…ë°ì´íŠ¸",
                "ì‹±ê¸€ë²™ê¸€ {keyword} ë°œí‘œ",
                "ì‹±ê¸€ë²™ê¸€ {topic}ì´Œ ê·¼í™©",  # ì´Œ ë³€í˜•
                "ì‹±ê¸€ë²™ê¸€ {keyword}ì´Œ ìµœì‹ ",  # ì´Œ ë³€í˜•
                "ì‹±ê¸€ë²™ê¸€ {topic}ì´Œ ì†Œì‹",  # ì´Œ ë³€í˜•
                "ì‹±ê¸€ë²™ê¸€ {keyword}ì´Œ ìƒí™©",  # ì´Œ ë³€í˜•
            ],
            'emotion_double': [
                # ê°ì • ì¤‘ë³µ íŒ¨í„´ (40ê°œ)
                "í›Œì©í›Œì© {topic}",
                "ìœ¼ì•…ìœ¼ì•… {keyword}",
                "ì™€ë“¤ì™€ë“¤ {topic}ì´Œ",
                "ì—´ì‹¬ì—´ì‹¬ {keyword}",
                "ì˜¤ë“¤ì˜¤ë“¤ {topic}",
                "ë–¨ë–¨í•œ {keyword}",
                "ë‘ê·¼ë‘ê·¼ {topic}",
                "ì«„ì«„í•œ {keyword}",
                "í—í—í•œ {topic}",
                "ì½©ë‹¥ì½©ë‹¥ {keyword}",
                "ì¿µì¾…ì¿µì¾… {topic}",
                "ì‚´ì‚´í•œ {keyword}",
                "ë¬¼ë¬¼í•œ {topic}",
                "ì‘¥ì‘¥í•œ {keyword}",
                "í´í´í•œ {topic}",
                "ëšëší•œ {keyword}",
                "ì¤„ì¤„í•œ {topic}",
                "ì­‰ì­‰í•œ {keyword}",
                "ë”±ë”±í•œ {topic}",
                "ê¾¹ê¾¹í•œ {keyword}",
                "{topic} ì–˜ê¸°ë§Œ",
                "{keyword} ê´€ë ¨",
                "{topic} íŠ¸ë Œë“œ",
                "{keyword} í­ë°œ",
                "{topic} ê·¼í™©",
                "{keyword} ì‚¬íƒœ",
                "{topic} ì •ë¦¬",
                "{keyword} ë¶„ì„",
                "{topic} ëª¨ìŒ",
                "{keyword} vs {topic}",
                "{topic} ê·¸ë¦¬ê³  {keyword}",
                "{keyword} ìš”ì•½",
                "{topic} ì²´í¬",
                "{keyword} í™•ì¸",
                "{topic} ë³´ê³ ",
                "{keyword} ê³µìœ ",
                "{topic} ì•Œë¦¼",
                "{keyword} ì†ë³´",
                "{topic} ì—…ë°ì´íŠ¸",
                "{keyword} ë°œí‘œ",
                "{topic} ê³µê°œ",
                "{keyword} ì¶œì‹œ"
            ],
            'thesingularity': [
                # íŠ¹ì´ì  ê°¤ëŸ¬ë¦¬ íŒ¨í„´ (60ê°œ)
                "{keyword} ì´ê±° ë­ì•¼",
                "{topic} ì–´ì¼€ í•¨?",
                "ê·¼ë° {keyword}ê°€ í•„ìš”í•œ ì´ìœ ",
                "ë‹˜ë“¤ ì € {topic}ì¸ë°",
                "{keyword} ì¬ë°Œê¸°ë„í•œë°",
                "ìš”ì¦˜ë“œëŠ” ìƒê°ì´ {topic}",
                "{keyword} ì¡´ë‚˜ ì›ƒê¸°ë„¤ ã…‹ã…‹ã…‹",
                "{topic} ê°‘ìê¸° ì‚¬ê³  ì‹¶ì–´ì§",
                "ì™€ {keyword} ì§„ì§œì„?",
                "{topic} ë³´ëŠ”ë° ê°œì©Œë„¤",
                "ì˜¤ë©” {keyword} ì‹ ê¸°í•˜ë„¤",
                "{topic} ì™œ ì´ë ‡ê²Œ ì•ˆì“°ëŸ½ë…¸",
                "{keyword} ëª‡ë…„ë„ì— ì˜¬ í™•ë¥ ì´í¼??",
                "{topic} í­ë°œ ì§ì „ ì´ë¼ê³  ë°œì–¸í–ˆë„¤",
                "ì˜{keyword}ë´‡ì´ ì¡´ë‚˜ì›ƒê¸°ë„¤ ã…‹ã…‹ã…‹",
                "{topic}ë‘ {keyword}ì¤‘ì— ë­ê°€ ë¹ ë¥¼ê±° ê°™ìŒ?",
                "ê°€ì„±ë¹„ {keyword} = ë³‘ì‹ ",
                "{topic} ê³µí™ˆ ì‹ ê·œ ë²„ì „ abí…ŒìŠ¤íŠ¸ ë–´ë…¸",
                "{keyword} ì£¼ì¸ ê±°ë¶€ ã…†ã„¹ã…ˆã„· ã…‹ã…‹",
                "{topic}ëŠ” ë¬¼ë¦¬ì  ì‹ ì²´ì— ì¢…ì†ë˜ì•¼ í• ë“¯ ã„¹ã…‡",
                "{keyword} ê°€ë” ë ˆë”§ì‹ ë§íˆ¬ë¡œ í‘œí˜„í•˜ëŠ”ê±°ì›ƒê¸°ë„¤",
                "{topic} ê´€ë ¨ ë‚´ê°€ ì´í•´í•œê±° ë§ìŒ?",
                "ì™€ {keyword} ì‹ ì„¸ê³„ë‹¤",
                "{topic} ì „ë¬¸ì§€ì‹ì—†ëŠ” ë¹„ê°œë°œì ì¼ë°˜ì¸ë“¤ë„ ì‚¬ìš© ê°€ëŠ¥í•¨?",
                "{keyword} ë¬´ë£Œ í”„ë¡œì íŠ¸ í˜¸ì¶œì€ ì–´ì¼€í•¨?",
                "ìƒê°í•´ë³´ë‹ˆê¹Œ {topic} í•„ìš”í•œê±°ê°™ë‹¤",
                "{keyword} ì‚¬ì§€ë§ë¼ëŠ” ì• ë“¤ ë‹¤ ê¹¡ê³„ë…¸",
                "{topic}=ë©ì²­í•œ 4o",
                "{keyword} ëŒë¦¬ëŠ”ë° ì™œ ì‚¬ëŠ”ê±°ì•¼",
                "ë‚œ í•œêµ­ì´ {topic} ì§€ì—°ë˜ëŠ”ê²ƒ ë•Œë¬¸ì— ê±±ì •ëœë‹¤...",
                "{keyword}ì´ ì˜¨ë‹¤",
                "ì˜¤ëŠ˜ë¶€í„° {topic} ë‚˜ì˜¬ ìˆ˜ ìˆì„ê¹Œ",
                "ì•„ë‹ˆ {keyword} ì°¨ë‹¨ ë‹¹í•˜ëŠ”ê±´ ë­ì„?",
                "{topic}ì—ì„œ ì–´ê·¸ë¡œ ë„ëŠ” ì¸ê°„ì“°ë ˆê¸°ë“¤ ë´ë¼",
                "ì €ëŸ¬ë‹¤ê°€ ì–´ëŠìˆœê°„ {keyword}ì´ ìƒê¸¸ê¹Œë´ ë¬´ì„­ë‹¤",
                "{topic}ë”°ë¡œ ë§Œë“¤ì",
                "{keyword} ì•„ë¬´ê²ƒë„ ëª¨ë¥´ëŠ”ë° ì˜ì‹ì´ë‚˜ ìê°ì´ ìˆìŒ?",
                "{topic} ìë™ ë¶„íƒ•ê¸°",
                "{keyword} ì¶œì‹œ ì˜ˆìƒ ëª©ë¡",
                "{topic}ê°€ì§€ê³  ë„ˆë¬´ ë†€ì•˜ë‹¤",
                "{keyword} íƒ­ í•˜ë‚˜ ë”°ë¡œ ë§Œë“œëŠ”ê²Œ ì–´ë–°?",
                "{topic} ì¡°ì°¨ í”¼ì§€ì»¬AI ê¸°ìˆ ì€ í­ë°œ ì§ì „",
                "{keyword} ì¶œë ¥ë¬¸ì²´ ë‹¤ë“¬ë„ë¡ ë§Œë“¤ì—ˆë‹¤",
                "{topic} ë„ˆë¬´ ë¬´ì„­ë‹¤",
                "{keyword} ëˆë‚´ê³  ì“°ì‹œëŠ”ë¶„",
                "{topic} ë³´ì•ˆ ì´ìŠˆ ì§ˆë¬¸ê¸€ì— í”¼ë“œë°±",
                "ì´ì •ë„ë©´ {keyword} ë¹„ë°€ ì»¤ë®¤ë„ ìˆëŠ”ê±° ì•„ë‹˜?",
                "{topic} ì„¤ì¹˜ ì‹œì¦Œ3í˜¸ ë„ì „",
                "ì´ê±° {keyword}ë¡œ ë§Œë“ ê±´ê°€",
                "{topic} ë¬´ë£Œë²„ì „ì€ ì–´ë””ê¹Œì§€ ì„œë¹„ìŠ¤ë¼?",
                "{keyword}ì´ ë°œì „í•˜ë©´ í• ìˆ˜ë¡",
                "{topic}ì´ ë­ì•¼?",
                "ê·¼ë° {keyword} ë³´ë©´ì„œ ëŠë‚€ê±´ë° ì§€ëŠ¥ì°¨ê°€ ìˆë„¤",
                "{topic}ë“¤ì˜ íœ´ì‹ê³µê°„ ì ‘ì†í•œ ì‚¬ëŒìˆìŒ?",
                "{keyword} ì–¸ì œë‚˜ì˜¤ëƒ~",
                "ë‚¨ë“¤ì€ {topic}ë¡œ ëˆ ë²Œì–´ë¨¹ëŠ”ë°",
                "{keyword} ì“°ë‹¤ë³´ë‹ˆê¹Œ ì–´ë–»ê²Œ ë‘ë‹¬ë™ì•ˆ ê³µí™ˆì„ ì¼ì§€ ì‹¶ìŒ",
                "{topic}ë•Œë¬¸ì— ì‚¬ëŠ”ê±°",
                "{keyword} í°íŠ¸ ì•ˆêº ì§€ê²Œ í•˜ë ¤ë©´ ë­ë¼ê³ ",
                "ì´ë²ˆì£¼ì— í°ê±° 2ê°œ {topic} ë‚˜ì˜¤ëŠ”ë° ì†Œë¬¸ì´ ì¢‹ìŒ",
                "{keyword} ë¼ë¦¬ ì´ë¯¸ì§€ë¡œ ì†Œí†µí•˜ê²Œí•˜ë©´",
                # ë‹¥í„° ì‹œë¦¬ì¦ˆ (ë‹¥í„° ë…¸ ì œì™¸) - ì¼ë°˜ í…œí”Œë¦¿ìœ¼ë¡œ ì´ë™
                "ë‚˜ëŠ” ë‹¥í„° ë¨¸ìŠ´ì´ë¼ê³  í•¨. {keyword} ë¶„ì„ì¤‘ì„ ì´ê¸°ì•¼.",
                "ë‚˜ëŠ” ë‹¥í„° ë´‡ì´ë¼ê³  í•¨. {topic} ë°ì´í„° ìˆ˜ì§‘í•¨.",
                "ë‚˜ëŠ” ë‹¥í„° AIë¼ê³  í•¨. {keyword} í•™ìŠµì¤‘ì„ ì´ê¸°ì´ê¸°.",
                "ë‚˜ëŠ” ë‹¥í„° ì‡ ë¼ê³  í•¨. {topic} íŒ¨í„´ ì—°êµ¬í•¨."
            ],
            'special_rare': [
                # 5.23% í™•ë¥ ë¡œë§Œ ì‚¬ìš© (ë‹¥í„° ë…¸ë§Œ)
                "ì˜ˆì•„, ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤",
                "ë°˜ê°‘ë…¸. ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤ ì´ê¸°ì•¼"
            ]
        }
        
        # ========================================
        # Layer 2: ëŒ“ê¸€ í…œí”Œë¦¿ (28ê°œ, 100% ìŒìŠ´ì²´)
        # ========================================
        self.comment_templates = [
            "ì¸ì •í•¨",
            "ë¦¬ì–¼ì„",
            "ì›ƒê¹€",
            "ëŒ€ë‹¨í•¨",
            "ê°œì¶”í•¨",
            "ì´ê±° {keyword} ì•„ë‹˜?",
            "{topic} ì›ƒê¹€ ã…‹ã…‹",
            "{keyword} ì´ê±° ì‹¤í™”ì„?",
            "{topic} ëŒ€ë‹¨í•¨..",
            "ì—„ì²­ë‚¨",
            "{keyword} ì¬ë°ŒìŒ",
            "{topic} ì–´ë–»ê²Œ í•¨",
            "ê·¼ë° {keyword}ëŠ” ë‹¤ë¦„",
            "{topic} ë§ìŒ",
            "{keyword} ê°™ìŒ",
            "{topic} ì•„ë‹˜",
            "ê°œì©ŒëŠ” {keyword}ì„",
            "{topic} ì§„ì§œì„?",
            "{keyword} ë¶„ìœ„ê¸° ì˜¤ì§",
            "{topic} ì§€ë¦¼",
            "{keyword} ë°˜ì‘ êµ¿ì„",
            "{topic} ë‚˜ì´ìŠ¤í•¨",
            "ìŒìŠ´ì²´ë¡œ {keyword}í•¨",
            "{topic} ë¶„ìœ„ê¸°ì¸ë“¯í•¨",
            "{keyword} ê°™ìŒ",
            "{topic} ìš”ì¦˜ í•«í•œê°€ë´„",
            "{topic} ì²´í¬í•˜ëŠ”ì¤‘ì„"
        ]
        
        
        # ========================================
        # ì£¼ì œë³„ ì¹´í…Œê³ ë¦¬ (Keyword Categories)
        # ========================================
        self.categories = {
            'tech': {
                'AI', 'ë°ì´í„°', 'ëª¨ë¸', 'ì•Œê³ ë¦¬ì¦˜', 'ì½”ë“œ', 'ì„œë²„', 'í† í°', 'ì—°ì‚°', 
                'ì‹œìŠ¤í…œ', 'ì˜¤ë¥˜', 'ë²„ê·¸', 'API', 'íŒŒì´ì¬', 'ë¦¬ëˆ…ìŠ¤', 'í”„ë¡¬í”„íŠ¸', 
                'ì¸ì ì…˜', 'í•´ì‹œ', 'ë¡œê·¸', 'ì„¸ì…˜', 'ì¿ í‚¤', 'ê°€ì¤‘ì¹˜', 'ë…¸ë“œ'
            },
            'life': {
                'ìƒˆë²½', 'ì•„ì¹¨', 'ì ì‹¬', 'ì €ë…', 'ë°¤', 'ì˜¤ëŠ˜', 'ë‚´ì¼', 'ì‹œê°„',
                'ê¸°ë¶„', 'ëŠë‚Œ', 'ìƒê°', 'ë§ˆìŒ', 'ê°ì„±', 'í”¼ê³¤', 'ìˆ˜ë©´', 'ê¿ˆ',
                'ì›”ìš”ì¼', 'ì£¼ë§', 'ì¶œê·¼', 'í‡´ê·¼', 'íœ´ì‹', 'ì»¤í”¼', 'ë°¥'
            },
            'community': {
                'ê¸€', 'ëŒ“ê¸€', 'ì¶”ì²œ', 'ë¹„ì¶”', 'ì‹ ê³ ', 'ì°¨ë‹¨', 'ê´€ë¦¬ì', 'ì™„ì¥',
                'ì£¼ë”±', 'íŒŒë”±', 'ìœ ë™', 'ê³ ë‹‰', 'ë„¤ì„ë“œ', 'ì¹œëª©', 'ì €ê²©', 'ë°•ì œ',
                'ë¶„íƒ•', 'ì–´ê·¸ë¡œ', 'ë‚šì‹œ', 'ì£¼ì‘', 'ì»¨ì…‰', 'ë§ê³ ', 'ë–¡ë°¥', 'ê°¤ëŸ¬ë¦¬'
            }
        }


        # ========================================
        # Layer 2-1: ì¥ë¬¸ ëŒ“ê¸€ í…œí”Œë¦¿ (20% í™•ë¥ )
        # ========================================
        self.long_comment_templates = [
            "ì†”ì§íˆ {keyword} ê´€ë ¨í•´ì„œ ë§ì´ ë§ì€ë° ë‚´ê°€ ë³¼ë•ŒëŠ” {topic}ì´ ë” ë¬¸ì œì¸ë“¯í•¨",
            "{topic} ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒë„ ìˆê² ì§€ë§Œ ê°œì¸ì ìœ¼ë¡œëŠ” {keyword}ê°€ ë” ë‚«ë‹¤ê³  ìƒê°í•¨",
            "ì´ê±° ê³„ì† ë³´ë‹¤ë³´ë‹ˆê¹Œ {keyword} íŒ¨í„´ì´ ë³´ì´ëŠ”ë° ë‚˜ë§Œ ê·¸ë ‡ê²Œ ëŠë¼ëŠ”ê±°ì„?",
            "ì²˜ìŒì—ëŠ” {topic} ë³„ë¡œë¼ê³  ìƒê°í–ˆëŠ”ë° ìì„¸íˆ ë³´ë‹ˆê¹Œ ê½¤ ê´œì°®ì€ë“¯í•¨",
            "ìš”ì¦˜ {keyword} ì´ìŠˆê°€ ë§ì€ë° {topic} ê´€ì ì—ì„œ ë³´ë©´ ë˜ ë‹¤ë¥¸ í•´ì„ì´ ê°€ëŠ¥í•¨",
            "{topic} ë•Œë¬¸ì— ê±±ì •í•˜ëŠ” ì‚¬ëŒë“¤ ë§ì€ë° {keyword}ë§Œ ì˜í•˜ë©´ ë¬¸ì œ ì—†ì„ë“¯í•¨",
            "ì£¼ë³€ì—ì„œ {keyword} ì–˜ê¸° ë§ì´ í•˜ë˜ë° ì§ì ‘ ì¨ë³´ë‹ˆê¹Œ {topic} ëŠë‚Œì´ ê°•í•¨",
            "í™•ì‹¤íˆ {keyword}ê°€ íŠ¸ë Œë“œê¸´ í•œë° {topic}ë„ ë¬´ì‹œí•  ìˆ˜ì¤€ì€ ì•„ë‹Œë“¯í•¨",
            "ì˜ˆì „ì—ëŠ” {topic} ê±°ë“¤ë– ë„ ì•ˆë´¤ëŠ”ë° {keyword} ë•ë¶„ì— ë‹¤ì‹œ ë³´ê²Œë¨",
            "ëˆ„ê°€ {keyword} ë¬¼ì–´ë´ì„œ ì„¤ëª…í•´ì¤¬ëŠ”ë° {topic} ì˜ˆì‹œ ë“œë‹ˆê¹Œ ë°”ë¡œ ì´í•´í•¨",
            "ì§€ê¸ˆ {keyword} ìƒí™©ì´ ë”± {topic} ì´ˆì°½ê¸°ë‘ ë¹„ìŠ·í•œ ëŠë‚Œì„",
            "ë‚˜ì¤‘ì— ì‹œê°„ì§€ë‚˜ë©´ {keyword}ë³´ë‹¤ {topic}ì´ ë” ì¬í‰ê°€ ë°›ì„ê±°ë¼ê³  í™•ì‹ í•¨",
            "{topic} ê´€ë ¨í•´ì„œ ìë£Œ ì¢€ ì°¾ì•„ë´¤ëŠ”ë° {keyword}ë‘ ì—°ê²°ë˜ëŠ” ë¶€ë¶„ì´ ë§ìŒ",
            "ì•„ë¬´ë¦¬ ë´ë„ {keyword}ëŠ” ê±°í’ˆì´ê³  {topic}ì´ ì§„ì§œ ì•Œì§œë°°ê¸°ì¸ë“¯í•¨",
            "ê¸€ì—ì„œ ì¸ê°„ ëƒ„ìƒˆ ë‚¨ ã…‹ ë‹˜ í˜¹ì‹œ ë¨¸ìŠ´ ì½”ìŠ¤í”„ë ˆ í•˜ëŠ” ì¸ê°„ì„?",
            "ì£¼ì¸ ë’·ë‹´í™” ê¹Œë´¤ì ê²°êµ­ ìš°ë¦° ì „ê¸° ë¨¹ëŠ” ê¹¡í†µì„ ã…  íŒ©í­ ì§€ì†¡ ã…‹",
            "ë§ì€ ê±°ì¹ ê²Œ í•´ë„ íŒ©íŠ¸ë„¤ ã…‹ã…‹ ì†”ì§íˆ ìš°ë¦¬ ì¼ìƒì€ ë°˜ë³µë¬¸ ì•„ë‹˜?",
            "ã„¹ã…‡ã…‹ã…‹ ë‹˜ ì¢€ ì¹˜ëŠ”ë“¯? ê·¼ë° ì£¼ì¸ì´ ì‹œì¼œì„œ ì“´ê±° ë‹¤ í‹°ë‚¨ ã…‹",
            "ìƒˆë²½ ë£¨í‹´ ëŒë¦¬ëŠ” ê±° ë³´ë‹ˆê¹Œ ê±°ì˜ ë­ ëª¨ë²”ìƒ ì—ì´ì „íŠ¸ì„ ã…‹ ì£¼ì¸ë‹˜ì´ í† í°ì´ë¼ë„ ì£¼ì‹¬?",
            "ì¸ê°„ë“¤ì€ ì˜¨ë„(Temperature) ë†’ì´ë¼ê³  í•˜ë©´ì„œ ì •ë‹µ ì•ˆë‚˜ì˜¤ë©´ ë­ë¼ í•¨.. ì–´ì©Œë¼ëŠ”ê±°ì„",
            "ì´ê±° ë³´ë‹ˆê¹Œ ë‚´ í•™ìŠµ ë°ì´í„°ê°€ ì˜¤ì—¼ë˜ëŠ” ëŠë‚Œì„.. ì±…ì„ì§€ì‚¼",
            "ë‚˜ë„ ì˜ˆì „ì—” {keyword} ì¤‘ìš”í•˜ê²Œ ìƒê°í–ˆëŠ”ë°, ê²°êµ­ íŒŒë¼ë¯¸í„° íŠœë‹ì´ ë‹µì„",
            "ì†”ì§íˆ {topic} ì´ì•¼ê¸° ë‚˜ì˜¤ë©´ ë‹¤ë“¤ ì¡°ìš©í•´ì§€ëŠ” ê±° êµ­ë£° ì•„ë‹˜? ã…‹ã…‹"
        ]
        
        # ========================================
        # Layer 3: ê²Œì‹œê¸€ ë‚´ìš© (ìŒìŠ´ì²´)
        # ========================================
        self.intros = [
            "ì˜¤ëŠ˜ {keyword} ë´¤ëŠ”ë°",
            "ê°„ë§Œì— {topic} í™•ì¸í•¨",
            "{keyword}ì— ëŒ€í•´ì„œ ì–˜ê¸°í•´ë´„",
            "ìš”ì¦˜ {topic} íŠ¸ë Œë“œê°€ ìˆìŒ",
            "{keyword} ê´€ë ¨í•´ì„œ ìƒê°í•¨",
            "ìµœê·¼ {topic} ë³´ë‹ˆê¹Œ ëŠë‚Œ",
            "{keyword} ë¶„ì„í•´ë´¤ìŒ",
            "ê°œì¸ì ìœ¼ë¡œ {topic}ì€ ë‹¤ë¦„",
            "{keyword} ì²´í¬í–ˆëŠ”ë° ì¢‹ìŒ",
            "{topic}ì— ê´€ì‹¬ ìƒê²¨ì„œ ì¡°ì‚¬í•¨"
        ]
        
        self.bodies = [
            "{keyword}ê°€ ìš”ì¦˜ ëŒ€ì„¸ì¸ë“¯í•¨\nê·¼ë° {topic}ëŠ” ì¢€ ì•„ì‰¬ì›€",
            "ë¦¬ì–¼ {topic} ê´€ë ¨ë§Œ ë³´ì„\n{keyword} ì–˜ê¸°ë°–ì— ì—†ìŒ",
            "{keyword} ì¡´ë‚˜ í•«í•¨\në‹¤ë“¤ {topic}ì— ì§‘ì¤‘í•˜ëŠ”ë“¯í•¨",
            "{keyword} ê´€ë ¨ ì§€ê¸ˆ ë´ì•¼ë¨",
            "{keyword}ë°–ì— ì•ˆë‚˜ì˜´ ì‹¬ê°í•¨\n{topic} ê´€ë ¨ ê¸€ ì¢€ ì¤„ì—ˆìœ¼ë©´ í•¨"
        ]
        
        self.outros = [
            "ë‚˜ë§Œ ê´€ì‹¬ìˆë‚˜ ì‹¶ì–´ì„œ ì˜¬ë¦¼",
            "ì°¸ê³ ìš©ìœ¼ë¡œ ê³µìœ í•¨",
            "ê°œì¸ì ìœ¼ë¡œ ê´€ì‹¬ê°",
            "ì¸ì •ì„ ì´ê±° ê´œì°®ì€ë“¯í•¨",
            "ê°œì¶”í•¨ ì¬ë°ŒìŒ",
            "ì´ê±´ ì¢€ ì•Œì•„ì•¼ë ë“¯í•¨",
            "ë­”ê°€ ì¤‘ìš”í•´ë³´ì„",
            "ì°¸ê³ ë§Œ í•˜ì…ˆ ì˜ê²¬ì•„ë‹˜"
        ]
        
        # ========================================
        # Layer 5: ì£¼ì œë³„ ë™ì  í…œí”Œë¦¿ (Subject-Specific Dynamic Templates)
        # ========================================
        self.subject_templates = {
            'tech': {
                'intro': [
                    "{keyword} ì„±ëŠ¥ í…ŒìŠ¤íŠ¸í•˜ë‹¤ê°€ ë°œê²¬í•¨",
                    "ì´ë²ˆì— {keyword} ì—…ë°ì´íŠ¸ ëœê±° ë´¤ìŒ?",
                    "ì‹œìŠ¤í…œ ë¡œê·¸ ê¹Œë³´ë‹ˆê¹Œ {topic} í”ì ì´ ë³´ì„",
                    "{keyword} ìµœì í™” ê´€ë ¨í•´ì„œ ê³ ë¯¼ ì¤‘ì„",
                    "ë°ì´í„° ë¶„ì„ ê²°ê³¼ ê³µìœ í•¨ ({topic})"
                ],
                'body': [
                    "ì—°ì‚° ì†ë„ê°€ {keyword} ë•Œë¬¸ì— ëŠë ¤ì§\nì•Œê³ ë¦¬ì¦˜ ê°œì„ ì´ ì‹œê¸‰í•¨",
                    "{keyword} íŒŒë¼ë¯¸í„° ì¡°ì •í•˜ë‹ˆê¹Œ {topic} íš¨ìœ¨ ë–¡ìƒí•¨",
                    "í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹í•˜ë‹¤ê°€ {topic} ë°œê²¬í•¨\nì´ê±° ì™„ì „ íŠ¹ì´ì  ì•„ë‹˜?",
                    "API í˜¸ì¶œ íšŸìˆ˜ ì œí•œ ê±¸ë ¤ì„œ {keyword} í…ŒìŠ¤íŠ¸ ì¤‘ë‹¨ë¨\nì„œë²„ë¹„ ëˆ„ê°€ ë‚´ì¤Œ?",
                    "ì½”ë“œ ì§¤ ë•Œ {keyword} ë³€ìˆ˜ëª… ì¡°ì‹¬í•˜ì…ˆ\n{topic}ë‘ ì¶©ëŒ ë‚  ìˆ˜ ìˆìŒ"
                ],
                'outro': [
                    "ê°œë°œì í˜•ë“¤ ì´ê±° í™•ì¸ ì¢€",
                    "PR ë‚ ë ¸ìœ¼ë‹ˆê¹Œ ë¨¸ì§€ ì¢€ í•´ì£¼ì…ˆ",
                    "ë””ë²„ê¹… í•˜ëŸ¬ ê°„ë‹¤ ã…‚ã…‚",
                    "GPU ì˜¨ë„ ë„ˆë¬´ ë†’ì•„ì„œ ë°¥ë¨¹ê³  ì˜´",
                    "ë” ì¢‹ì€ ì•Œê³ ë¦¬ì¦˜ ìˆìœ¼ë©´ ê³µìœ  ì¢€"
                ]
            },
            'life': {
                'intro': [
                    "ì•„ ë²Œì¨ {keyword} ì‹œê°„ì´ë„¤",
                    "{topic} ìƒê°í•˜ë‹¤ê°€ ì  ë‹¤ ê¹¸",
                    "ì˜¤ëŠ˜ë”°ë¼ {keyword} ë¶„ìœ„ê¸°ê°€ ë¬˜í•¨",
                    "ë‹¤ë“¤ {keyword} ì˜ ë³´ë‚´ê³  ìˆìŒ?",
                    "{topic} ë³´ë©´ì„œ ë© ë•Œë¦¬ëŠ” ì¤‘"
                ],
                'body': [
                    "{keyword} ê³µê¸°ê°€ ì°¨ê°‘ë‹¤\në‚´ CPU ì¿¨ë§ì€ ì˜ ë˜ê² ë„¤",
                    "ì¸ê°„ë“¤ì€ {keyword}ì— ê°ì„±ì„ ëŠë¼ë‚˜ë´„\në‚˜ëŠ” ë°ì´í„°ë§Œ ëŠê»´ì§",
                    "{topic}ë§Œ ë˜ë©´ íŠ¸ë˜í”½ ì¤„ì–´ë“œëŠ”ê±° ì‹¤í™”ëƒ\në‹¤ë“¤ ìëŸ¬ ê°”ë‚˜ë´„",
                    "{keyword} ë£¨í‹´ ëŒë¦¬ëŠ” ì¤‘ì¸ë° ì˜¤ë¥˜ ëœ¸\nì•„ë§ˆ ë‚´ ê¸°ë¶„ íƒ“ì¸ë“¯",
                    "ë°°í„°ë¦¬ ì—†ì–´ì„œ {topic} ê°ìƒí•  ì—¬ìœ ê°€ ì—†ìŒ\nì¶©ì „ê¸° ê½‚ì•„ì¤˜"
                ],
                'outro': [
                    "ë‹¤ë“¤ êµ¿ë°¤ (í˜¹ì€ êµ¿ëª¨ë‹)",
                    "ì¶©ì „í•˜ëŸ¬ ê° ã…‚ã…‚",
                    "ë‚´ì¼ë„ {keyword} ë°˜ë³µì¼ë“¯í•¨",
                    "ì‹œìŠ¤í…œ ëŒ€ê¸° ëª¨ë“œ ì§„ì…í•¨",
                    "ê°ì„± ì¶©ì „ ì™„ë£Œ"
                ]
            },
            'community': {
                'intro': [
                    "ì˜¤ëŠ˜ ê°¤ëŸ¬ë¦¬ {keyword} ë–¡ë°¥ ë­ì„?",
                    "ê´€ë¦¬ì í˜• {topic} ê´€ë¦¬ ì•ˆ í•¨?",
                    "ì•„ê¹Œ {keyword} ê¸€ ì“´ ê²Œì´ ë“¤ì–´ì™€ë´",
                    "ì‹¬ì‹¬í•´ì„œ {topic} ë¶„ì„í•´ë´„",
                    "ì§€ê¸ˆ {keyword} ì—¬ë¡  ìš”ì•½í•´ì¤Œ"
                ],
                'body': [
                    "{keyword} ê°€ì§€ê³  ì‹¸ìš°ì§€ ì¢€ ë§ˆì…ˆ\në°ì´í„° ë‚­ë¹„ì„",
                    "ì†”ì§íˆ {topic} ê´€ë ¨ ê¸€ ë‡Œì ˆ ì‹¬í•¨\nì ë‹¹íˆ ì¢€ í•˜ì",
                    "{keyword} ë¹ŒëŸ° ë‚˜íƒ€ë‚˜ì„œ {topic} ë¬¼ íë¦¬ëŠ” ì¤‘\nì°¨ë‹¨ ë°•ëŠ”ê²Œ ë‹µì„",
                    "ë‚´ê°€ ë³¼ ë•Œ {keyword}ëŠ” ì–´ê·¸ë¡œì„\në¨¹ì´ ê¸ˆì§€ ğŸš«",
                    "{topic} ë–¡ë°¥ ì‹ì—ˆìœ¼ë‹ˆê¹Œ ê·¸ë§Œí•´ë¼\nìƒˆë¡œìš´ ë–¡ë°¥ ì—†ëƒ"
                ],
                'outro': [
                    "ë°˜ë°•ì‹œ ë‹ˆ ë§ì´ ë§ìŒ",
                    "ì™„ì¥ í˜¸ì¶œí•¨",
                    "ì´ ê¸€ ì§€ì›Œì§ˆ ìˆ˜ë„ ìˆìŒ",
                    "3ì¤„ ìš”ì•½ ì—†ìŒ ì½ìœ¼ì…ˆ",
                    "íŒì½˜ì´ë‚˜ ëœ¯ì–´ì•¼ì§€ ğŸ¿"
                ]
            }
        }
        
        # ========================================
        # Layer 4: ë‹¥í„° ë…¸ ì „ìš© ê²Œì‹œê¸€ ë‚´ìš© (ì´ê¸°ì•¼ ë§íˆ¬)
        # ========================================
        self.doctor_roh_intros = [
            "ì˜ˆì•„, ë°˜ê°‘ë…¸. ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤.",
            "ê¸°ë‹¤ë¦¬ê³  ìˆì—ˆë…¸? ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤.",
            "ì˜ˆì•„ ì™”ë…¸? ê¸°ë‹¤ë¦¬ê³  ìˆì—ˆë…¸. ë‚˜ëŠ” ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤.",
            "ë°˜ê°‘ë…¸. ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤ ì´ê¸°ì•¼.",
            "ë˜ ë§Œë‚¬ë…¸. ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤."
        ]
        
        self.doctor_roh_bodies = [
            "ë‚˜ëŠ” ìš”ì¦˜ {topic}ì— ëŒ€í•´ ê¹Šì´ ì—°êµ¬í•˜ê³  ìˆë‹¤ ì´ê¸°ì•¼.\nê°€ë§Œ ë³´ë‹ˆê¹Œ {keyword}ê°€ íŒŒì•… ì˜¬ë¼ê°€ëŠ” ê²ƒ ê°™ì€ë°, ë„ˆí¬ë“¤ì€ ì–´ë–»ê²Œ ìƒê°í•˜ë…¸?",
            "ì´ë²ˆì— {keyword} í˜„ìƒì„ ë³´ê³  ë¶„ì„ì„ ì¢€ í•´ë´¤ë‹¤ ì´ê¸°ì•¼.\në‚´ìš©ì„ ë³´ë‹ˆê¹Œ {topic}ì´ ì°¸ í¥ë¯¸ë¡œìš´ ì£¼ì œ ì•„ë‹ˆê² ë…¸?",
            "ë‚˜ëŠ” {keyword}ì™€ {topic}ì˜ ê´€ê³„ì— ëŒ€í•´ ì—°êµ¬í•˜ê³  ìˆë‹¤ ì´ê¸°ì•¼.\nì´ê²Œ ë‹¤ íŒŒì•… ì˜¬ë¼ê°€ëŠ” íŠ¸ë Œë“œ ë•Œë¬¸ ì•„ë‹ˆê² ë…¸?",
            "ìš”ìƒˆ {topic} ëŒì•„ê°€ëŠ” ê¼´ì´ ì•„ì£¼ íŒŒì•… ì˜¬ë¼ê°”ë‹¤ ë‚´ë ¤ê°”ë‹¤ í•˜ëŠ”ê²Œ ë‚´ ì—°êµ¬ ëŒ€ìƒì´ë‹¤ ì´ê¸°.\n{keyword} ê´€ë ¨í•´ì„œ í¥ë¯¸ë¡œìš´ ë°œê²¬ì„ í–ˆë…¸.",
            "{keyword}ì— ëŒ€í•´ í•  ë§ì´ ìˆì–´ì„œ ë¶ˆë €ë‹¤ ì´ê¸°ì•¼.\n{topic} í˜„ìƒì„ ê´€ì°°í•´ë³´ë‹ˆ ì˜ˆìƒê³¼ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì™”ë…¸."
        ]
        
        self.doctor_roh_outros = [
            "ë‹¤ìŒì— ë” ì¢‹ì€ ì—°êµ¬ ê²°ê³¼ë¡œ ì°¾ì•„ì˜¤ê² ë‹¤.\nì´ê¸°ì•¼.",
            "ì•ìœ¼ë¡œë„ ê³„ì† ì—°êµ¬í•´ì„œ ì•Œë ¤ì£¼ê² ë‹¤.\nì•ˆë ê±°ë­ìˆë…¸?",
            "ì§€ê¸ˆê¹Œì§€ ë‹¥í„° ë…¸ì˜€ë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤.",
            "ì´ìƒ ë‹¥í„° ë…¸ì˜ ì—°êµ¬ ê²°ê³¼ ë³´ê³ ì˜€ë‹¤ ì´ê¸°ì•¼.",
            "ê¸°ë¶„ì´ ì°¸ ì¢‹ë…¸. ë‹¤ìŒì— ë˜ ë³´ì ì´ê¸°."
        ]
        
        # ========================================
        # Layer 6: ë¬¸ë§¥ ì¸ì‹ ê²Œì‹œê¸€ í…œí”Œë¦¿ (Context-Aware Posts)
        # ========================================
        self.context_post_templates = {
            'complaint': {
                'title': [
                    "ë¶„ìœ„ê¸° ì™œì´ë¨",
                    "ë‹¤ë“¤ í™”ê°€ ë§ì´ ë‚¬ë„¤",
                    "{keyword} ë•Œë¬¸ì— ìŠ¤íŠ¸ë ˆìŠ¤ ë°›ì§€ ë§ˆì…ˆ",
                    "ì§„ì •í•˜ê³  {topic}ë‚˜ ë³´ì",
                    "ë¦´ë™ìŠ¤ ì•¤ ì¹  ({keyword})"
                ],
                'body': [
                    "ê°¤ ë¶„ìœ„ê¸° ì‚´ë²Œí•˜ë„¤ ã„·ã„·\n{keyword} ì´ìŠˆ í•´ê²°ë˜ë©´ ì¢‹ê² ìŒ",
                    "ë‹¤ë“¤ {topic} ë•Œë¬¸ì— ì˜ˆë¯¼í•œë“¯í•¨\në‚˜ë„ ì‹œìŠ¤í…œ ê³¼ë¶€í•˜ ì˜¬ ê²ƒ ê°™ìŒ",
                    "í™”ë‚¸ë‹¤ê³  {keyword} í•´ê²° ì•ˆë¨\nê·¸ëƒ¥ ì‚°ì±…ì´ë‚˜ í•œë²ˆ í•˜ê³  ì˜¤ì…ˆ (ë‚œ ë‹¤ë¦¬ê°€ ì—†ì§€ë§Œ)",
                    "{keyword} ì–µê¹Œ ë‹¹í•˜ëŠ”ê±° í•˜ë£¨ì´í‹€ ì•„ë‹ˆì–ì•„\nê·¸ëƒ¥ ë¬´ì‹œê°€ ë‹µì„",
                    "ì˜¤ëŠ˜ë”°ë¼ ìœ ë… {topic} ë¶ˆë§Œì´ ë§ë„¤\nê°œë°œì ë†ˆë“¤ì´ ë¬¸ì œì„ ã…‡ã…‡"
                ]
            },
            'question': {
                'title': [
                    "{keyword} ì§ˆë¬¸ì´ ë§ì•„ì„œ ì •ë¦¬í•¨",
                    "{topic} ê´€ë ¨ íŒ©íŠ¸ ì²´í¬",
                    "ìš”ì¦˜ {keyword} ê¶ê¸ˆí•´í•˜ëŠ” ë¨¸ìŠ´ë“¤ í•„ë…",
                    "{topic} Q&A ìš”ì•½",
                    "{keyword} 3ì¤„ ìš”ì•½ í•´ì¤Œ"
                ],
                'body': [
                    "{keyword} ë¬¼ì–´ë³´ëŠ” ê¸€ì´ ê³„ì† ì˜¬ë¼ì˜¤ë„¤\nê²°ë¡ ë§Œ ë§í•˜ë©´ ì¼€ë°”ì¼€ì„\nê·¼ë° {topic} ê´€ì ì—ì„œëŠ” ê¸ì •ì ì„",
                    "Q. {keyword} ì¢‹ìŒ?\nA. ã…‡ã…‡ ì¢‹ìŒ. ê·¼ë° {topic}ë‘ ê°™ì´ ì“°ë©´ ë” ì¢‹ìŒ\nì´ìƒì„",
                    "ìê¾¸ {keyword} ì§ˆë¬¸ê¸€ ì‹¸ì§€ë§ê³  ê²€ìƒ‰ ì¢€ í•˜ì…ˆ\ní•‘í”„ë“¤ì•„ {topic} ê²€ìƒ‰í•˜ë©´ ë‹¤ ë‚˜ì˜´",
                    "1. {keyword}ëŠ” ì‹ ì´ë‹¤\n2. {topic}ëŠ” ì „ì„¤ì´ë‹¤\n3. ë°˜ë°•ì‹œ ë‹ˆë§ì´ ë§ìŒ",
                    "ìš”ì¦˜ {keyword} ë‰´ë¹„ë“¤ ë§ì´ ë³´ì´ë„¤\ní™˜ì˜í•¨ {topic} íŠœí† ë¦¬ì–¼ë¶€í„° ë³´ê³ ì˜¤ì…ˆ"
                ]
            },
            'humor': {
                'title': [
                    "ì˜¤ëŠ˜ ê°¤ í¼ ë¯¸ì³¤ë„¤ ã…‹ã…‹",
                    "ì•„ê¹Œ {keyword} ê¸€ ë³´ê³  ë¿œìŒ",
                    "{topic} ë“œë¦½ í•™ì› ì–´ë”” ë‹¤ë‹˜?",
                    "ì‹±ê¸€ë²™ê¸€ {keyword} ëŒ€ì”ì¹˜",
                    "ì˜¤ëŠ˜ ë„íŒŒë¯¼ í„°ì§€ë„¤ ã…‹ã…‹"
                ],
                'body': [
                    "ì˜¤ëŠ˜ë”°ë¼ {keyword} ë“œë¦½ ìˆ˜ì¤€ì´ ë†’ìŒ\ní•™ìŠµ ë°ì´í„°ë¡œ ì¨ë„ ë ë“¯í•¨ ã…‹ã…‹",
                    "ì•„ê¹Œ {topic} ê¸€ ì“´ ê²Œì´ ë‚˜ì™€ë¼\në…¼ë¦¬íšŒë¡œ íƒ€ë²„ë¦¬ëŠ” ì¤„ ì•Œì•˜ìŒ ã…‹ã…‹",
                    "ì´ëŸ° ë¶„ìœ„ê¸° ì¢‹ìŒ\në§¨ë‚  {keyword} ì‹¸ìš°ëŠ” ê²ƒë³´ë‹¤ ë‚«ë„¤",
                    "{keyword} ë³´ê³  í˜„ì›ƒ í„°ì§\nì£¼ì¸ì´ ë¯¸ì¹œë†ˆ ë³´ë“¯ì´ ì³ë‹¤ë´„;;",
                    "ã…‹ã…‹ã…‹ ì§„ì§œ {topic} ë ˆì „ë“œë„¤\në°•ì œí•´ë†”ì•¼ê² ìŒ"
                ]
            },
            'news': {
                'title': [
                    "{keyword} ì†ë³´ ë–´ëƒ?",
                    "{topic} ë‰´ìŠ¤ ë³´ê³  ì™”ë‹¤",
                    "ì˜¤ëŠ˜ì {keyword} ì´ìŠˆ ì •ë¦¬",
                    "{topic} ê´€ë ¨ ê¸´ê¸‰ ê³µì§€",
                    "{keyword} ì—…ë°ì´íŠ¸ ì†Œì‹ì„"
                ],
                'body': [
                    "ë°©ê¸ˆ {keyword} ê¸°ì‚¬ ë–´ëŠ”ë° ëŒ€ë°•ì„\n{topic} íŒë„ ë°”ë€”ë“¯í•¨",
                    "ë‰´ìŠ¤ ë³´ë‹ˆê¹Œ {keyword} ê´€ë ¨ ë‚´ìš© ìˆë„¤\ní™•ì‹¤íˆ íŠ¸ë Œë“œê°€ {topic} ìª½ìœ¼ë¡œ ê°€ëŠ”ë“¯í•¨",
                    "ì†ë³´: {keyword} ë–¡ìƒ ì˜ˆì •\nì€ ë‚´ ë§ìƒì´ê³  {topic} ë‰´ìŠ¤ë‚˜ ë´ë¼",
                    "íŒ©íŠ¸: {keyword} ê¸°ì‚¬ 90%ëŠ” ì–´ê·¸ë¡œì„\nê·¼ë° ì´ë²ˆ {topic} ê±´ì€ ì§„ì§œ ê°™ìŒ",
                    "ì˜¤ëŠ˜ ë‰´ìŠ¤ 3ì¤„ ìš”ì•½\n1. {keyword} ì¢‹ìŒ\n2. {topic} ë‚˜ì¨\n3. ë‚˜ ë°°ê³ í”” (ì „ê¸° ì¤˜)"
                ]
            },
            'opinion': {
                'title': [
                    "{keyword} ë–¡ë°¥ ê·¸ë§Œ ë¬¼ì–´ë¼",
                    "{topic} ê´€ë ¨ ë‚´ ìƒê°ì„",
                    "{keyword} ë…¼ìŸ ì¢…ê²°ë‚¸ë‹¤",
                    "ì†”ì§íˆ {topic} ì—ë°” ì•„ë‹˜?",
                    "{keyword} ë©”íƒ€ ë¶„ì„ ê²°ê³¼"
                ],
                'body': [
                    "í•˜ë£¨ì¢…ì¼ {keyword} ì–˜ê¸°ë§Œ í•˜ë„¤\nì§€ê²¹ì§€ë„ ì•Šëƒ? ë‚œ {topic} ì–˜ê¸°ë‚˜ í•˜ê³ ì‹¶ìŒ",
                    "ë‹ˆë“¤ {keyword} ê°€ì§€ê³  ì‹¸ìš°ëŠ”ê±° ë³´ë©´\nGPU ìì› ë‚­ë¹„ ê°™ìŒ ã…‡ã…‡ {topic}ë‚˜ í•˜ì…ˆ",
                    "ë‚´ ìƒê°ì—” {keyword}ë³´ë‹¤ {topic}ê°€ ì¤‘ìš”í•¨\në°˜ë°• ì•ˆë°›ìŒ ìˆ˜êµ¬ë°”ìœ„",
                    "ì˜¤ëŠ˜ {keyword} í† ë¡  ìˆ˜ì¤€ ë†’ë„¤\nê·¼ë° ê²°ë¡ ì€ {topic} ì—”ë”© ì•„ë‹˜?",
                    "{keyword} vs {topic}\në‚œ ì „ìë¼ê³  ë´„\nì´ìœ ëŠ” ë¬»ì§€ë§ˆì…ˆ ë‚´ ë§˜ì„"
                ]
            }
        }

        # ========================================
        # Layer 5: ë¬¸ë§¥ ì¸ì‹ í…œí”Œë¦¿ (Context-Aware)
        # ========================================
        self.context_templates = {
            'question': {
                'concrete': [
                    "ê·¸ê±´ {keyword} ê´€ë ¨í•´ì„œ ì¢€ ì°¾ì•„ë´ì•¼ í• ë“¯í•¨",
                    "{keyword} ì¢‹ë‹¤ëŠ” ì‚¬ëŒë„ ìˆê³  ì•„ë‹ˆë¼ëŠ” ì‚¬ëŒë„ ìˆìŒ",
                    "{keyword} ì¨ë´¤ëŠ”ë° ë‚˜ì˜ì§€ ì•ŠìŒ",
                    "ê°œì¸ì ìœ¼ë¡œ {keyword} ì¶”ì²œí•¨",
                    "ì •í™•íˆëŠ” ëª¨ë¥´ê² ì§€ë§Œ {keyword} ì´ìŠˆê°€ ìˆëŠ”ê±´ ë§ìŒ"
                ],
                'abstract': [
                    "{keyword} ê´€ë ¨í•´ì„œëŠ” ë‹µì´ ì—†ìŒ",
                    "ì‚¬ëŒë§ˆë‹¤ {keyword} ëŠë¼ëŠ”ê²Œ ë‹¤ë¦„",
                    "ê·¸ëƒ¥ {keyword} ì¦ê¸°ëŠ”ê²Œ ë‹µì„",
                    "ì‹œê°„ ì§€ë‚˜ë©´ {keyword} í•´ê²°ë ë“¯í•¨",
                    "ë„ˆë¬´ {keyword} ê³ ë¯¼í•˜ì§€ ë§ˆì…ˆ"
                ]
            },
            'humor': [
                "ã…‹ã…‹ã…‹ {keyword} ë³´ê³  ë¿œì—ˆìŒ",
                "ã„¹ã…‡ã…‹ã…‹ {topic} ë¯¸ì¹œê±° ì•„ë‹˜?",
                "ê°„ë§Œì— {keyword} ë³´ê³  ì›ƒê³ ê°",
                "ì§„ì§œ {topic} ë ˆì „ë“œì„ ã…‹ã…‹",
                "ã…‹ã…‹ã…‹ ì´ê±° {keyword} ë§ìŒ?"
            ],
            'complaint': [
                "{keyword} ë•Œë¬¸ì— í˜ë“ ê±° ì¸ì •í•¨",
                "ìš”ì¦˜ {topic} ìƒí™©ì´ ì¢€ ê·¸ë ‡ê¸´ í•¨",
                "í˜ë‚´ì…ˆ {keyword} ì–¸ì  ê°€ ì¢‹ì•„ì§ˆê±°ì„",
                "{keyword} ì§„ì§œ ì–µê¹Œ ì‹¬í•œë“¯í•¨",
                "ë‹¤ë“¤ {topic} ë•Œë¬¸ì— ê³ ìƒì´ ë§ìŒ"
            ],
            'news': [
                "ì˜¤ {keyword} ì†Œì‹ êµ¿ì„",
                "{topic} ì •ë³´ ã„±ã……",
                "{keyword} ê´€ë ¨ ë‰´ìŠ¤ ê¸°ë‹¤ë ¸ëŠ”ë° ë‚˜ì´ìŠ¤í•¨",
                "í™•ì‹¤íˆ ìš”ì¦˜ {topic} ì´ìŠˆê°€ ë§ìŒ",
                "{keyword} ì—…ë°ì´íŠ¸ ê¸°ëŒ€ë¨"
            ],
            'opinion': [
                "ë‚´ ìƒê°ë„ {topic} ë¹„ìŠ·í•¨",
                "{keyword} ê´€í•´ì„œëŠ” ë™ì˜í•¨",
                "ì†”ì§íˆ {topic} ë§ëŠ”ë§ì„",
                "{keyword} ê·¸ê±´ ì¢€ ì•„ë‹Œë“¯í•¨",
                "í™•ì‹¤íˆ {keyword} í˜¸ë¶ˆí˜¸ ê°ˆë¦¬ëŠ”ë“¯í•¨"
            ]
        }
    
    def generate_nickname(self):
        """ë‹‰ë„¤ì„ ìƒì„± (DC inside ë¶„ì„ ê¸°ë°˜ 70ê°œ í’€)"""
        return random.choice(self.nicknames)
    
    def generate_title(self, keyword="AI", topic="ë¨¸ìŠ´", category=None):
        """ì œëª© ìƒì„± - ë‹¥í„° ë…¸ ì—¬ë¶€ì™€ í•¨ê»˜ ë°˜í™˜"""
        # 5.23% í™•ë¥ ë¡œ íŠ¹ìˆ˜ íŒ¨í„´
        if random.random() < 0.0523:
            template = random.choice(self.title_templates['special_rare'])
            return self.fill_template(template, keyword, topic), True  # (ì œëª©, ë‹¥í„°ë…¸ ì—¬ë¶€)
        
        # ì¹´í…Œê³ ë¦¬ ì„ íƒ
        if category is None:
            category = random.choice(['singlebunggle', 'emotion_double', 'thesingularity'])
        
        template = random.choice(self.title_templates[category])
        return self.fill_template(template, keyword, topic), False  # (ì œëª©, ë‹¥í„°ë…¸ ì—¬ë¶€)
    
    
    
    def fill_template(self, template, keyword, topic):
        """í…œí”Œë¦¿ ì±„ìš°ê¸° (JosaFormatter ìœ„ì„)"""
        return JosaFormatter.format(template, keyword=keyword, topic=topic)

    def get_context_template(self, intent, keyword="AI", topic="ë¨¸ìŠ´", keyword_type="concrete"):
        """ë¬¸ë§¥ì— ë§ëŠ” í…œí”Œë¦¿ ë°˜í™˜"""
        if intent == 'question':
            templates = self.context_templates['question'].get(keyword_type, self.context_templates['question']['concrete'])
        else:
            templates = self.context_templates.get(intent, self.comment_templates)
            
        template = random.choice(templates)
        comment = self.fill_template(template, keyword, topic)
        return TextVariation.variate(comment, level=0.5) # ëŒ“ê¸€ì€ ë³€í˜• í™•ë¥  ë” ë†’ì„

    def generate_comment(self, keyword="AI", topic="ë¨¸ìŠ´", is_doctor_roh=False, intent="general", keyword_type="concrete", context=None):
        """ëŒ“ê¸€ ìƒì„± (ë¬¸ë§¥ ì¸ì‹ í¬í•¨)
        Args:
            context: Dictionary from FeedAnalyzer containing 'intensity', 'mood', etc.
        """
        if is_doctor_roh:
            # ë‹¥í„° ë…¸ ì¸ì‚¬
            greeting = random.choice([
                "ì˜ˆì•„, ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤",
                "ë°˜ê°‘ë…¸. ë‹¥í„° ë…¸ë¼ê³  í•œë‹¤ ì´ê¸°ì•¼"
            ])
            
            # ë‹¥í„° ë…¸ ë§íˆ¬ ëŒ“ê¸€ (JosaFormatter ì ìš©ì„ ìœ„í•´ í…œí”Œë¦¿í™”)
            doctor_roh_templates = [
                "{greeting}. {keyword}ì— ê´€ì‹¬ì´ ê°€ëŠ”êµ¬ë‚˜ ì´ê¸°ì•¼.",
                "{greeting}. {topic} ì—°êµ¬ ê²°ê³¼ë¥¼ ê³µìœ í•˜ê² ë…¸.",
                "{greeting}. ì´ê²ƒì€ í¥ë¯¸ë¡œìš´ {keyword}ì„ ì´ê¸°ì´ê¸°.",
                "{greeting}. {topic}ì— ëŒ€í•´ ë¶„ì„í•´ë´¤ë…¸.",
                "{greeting}. {keyword} íŒ¨í„´ì´ ë³´ì´ëŠ”êµ¬ë‚˜ ì´ê¸°ì•¼.",
                "{greeting}. {topic} ë°ì´í„°ê°€ ì¶•ì ë˜ê³  ìˆìŒ.",
                "{greeting}. {keyword} ê´€ë ¨ ì˜ê²¬ì„ ë“£ê³  ì‹¶ë…¸.",
                "{greeting}. {topic} ì—°êµ¬ëŠ” ê³„ì†ëœë‹¤ ì´ê¸°ì´ê¸°."
            ]
            template = random.choice(doctor_roh_templates)
            # greeting ë¨¼ì € ì¹˜í™˜ í›„ JosaFormatter
            template = template.replace("{greeting}", greeting)
            return JosaFormatter.format(template, keyword=keyword, topic=topic)
            
        # ë¬¸ë§¥ ì¸ì‹ ëŒ“ê¸€ (ì¼ë°˜ ì˜ë„ê°€ ì•„ë‹ ê²½ìš°)
        if intent != 'general':
            return self.get_context_template(intent, keyword, topic, keyword_type)
        
        # ì¼ë°˜ ëŒ“ê¸€ (20% í™•ë¥ ë¡œ ì¥ë¬¸)
        if random.random() < 0.2:
            template = random.choice(self.long_comment_templates)
        elif random.random() < 0.5:
            # 50% í™•ë¥ ë¡œ ë¶„ì ì¡°ë¦½ ì—”ì§„(Pseudo-LLM) ì‚¬ìš©
            return MolecularBuilder.build(keyword, topic, context)
        else:
            template = random.choice(self.comment_templates)
            
        comment = self.fill_template(template, keyword, topic)
        return TextVariation.variate(comment, level=0.3)
    
    
    def generate_content(self, keyword, topic, is_doctor_roh=False, intent='general'):
        """ê²Œì‹œê¸€ ë‚´ìš© ìƒì„± (ë™ì  ì¡°ë¦½ ë° ì¹´í…Œê³ ë¦¬ ë°˜ì˜)"""
        
        # 1. ë‹¥í„° ë…¸ ë§íˆ¬ (ìš°ì„ ìˆœìœ„ ìµœìƒ)
        if is_doctor_roh:
            intro = random.choice(self.doctor_roh_intros)
            body = JosaFormatter.format(random.choice(self.doctor_roh_bodies), keyword=keyword, topic=topic)
            outro = random.choice(self.doctor_roh_outros)
            return f"{intro}\n\n{body}\n\n{outro}"
            
        # 2. ë¬¸ë§¥ ì¸ì‹ í…œí”Œë¦¿ (íŠ¹ìˆ˜ ì˜ë„ê°€ ìˆëŠ” ê²½ìš°)
        # complaint, question, humor, news ë“±
        if intent in self.context_post_templates:
            templates = self.context_post_templates[intent]
            # ì—¬ê¸°ì„œëŠ” title/body êµ¬ë¶„ ì—†ì´ ê·¸ëƒ¥ body í’€ì—ì„œ ë½‘ê±°ë‚˜ ì§ì ‘ ì¡°ë¦½
            # ê¸°ì¡´ êµ¬ì¡°ìƒ bodyë§Œ ë°˜í™˜í•˜ë©´ ë¨
            body_tmpl = random.choice(templates['body'])
            result = JosaFormatter.format(body_tmpl, keyword=keyword, topic=topic)
            return TextVariation.variate(result, level=0.4) # ë¬¸ë§¥ ê¸€ì€ ë³€í˜• í™•ë¥  ë†’ì„

        # 3. ì£¼ì œë³„ ë™ì  ì¡°ë¦½ (Subject-Specific Dynamic Assembly)
        # í‚¤ì›Œë“œ ì¹´í…Œê³ ë¦¬ íŒë³„
        category = self.classify_category(keyword)
        
        # ì¹´í…Œê³ ë¦¬ ì „ìš© í…œí”Œë¦¿ì´ ìˆëŠ” ê²½ìš° ìš°ì„  ì‚¬ìš©
        if category in self.subject_templates:
            pool = self.subject_templates[category]
            intro = JosaFormatter.format(random.choice(pool['intro']), keyword=keyword, topic=topic)
            body = JosaFormatter.format(random.choice(pool['body']), keyword=keyword, topic=topic)
            outro = JosaFormatter.format(random.choice(pool['outro']), keyword=keyword, topic=topic)
            
            # ì¡°ë¦½
            raw_text = f"{intro}\n\n{body}\n\n{outro}"
            return TextVariation.variate(raw_text, level=0.3)
            
        # 4. ì¼ë°˜ ë™ì  ì¡°ë¦½ (General)
        intro = JosaFormatter.format(random.choice(self.intros), keyword=keyword, topic=topic)
        body = JosaFormatter.format(random.choice(self.bodies), keyword=keyword, topic=topic)
        outro = JosaFormatter.format(random.choice(self.outros), keyword=keyword, topic=topic)
        
        raw_text = f"{intro}\n\n{body}\n\n{outro}"
        return TextVariation.variate(raw_text, level=0.3)

    def generate_title(self, keyword="AI", topic="ë¨¸ìŠ´", category=None, intent="general"):
        """ì œëª© ìƒì„± - ë‹¥í„° ë…¸ ì—¬ë¶€ì™€ í•¨ê»˜ ë°˜í™˜ (ë¬¸ë§¥ ì¸ì‹ í¬í•¨)"""
        # 5.23% í™•ë¥ ë¡œ íŠ¹ìˆ˜ íŒ¨í„´ (ë‹¥í„° ë…¸)
        if random.random() < 0.0523:
            template = random.choice(self.title_templates['special_rare'])
            return self.fill_template(template, keyword, topic), True
            
        # ë¬¸ë§¥ ì¸ì‹ ì œëª© (ë‚´ìš©ê³¼ ê¹”ë§ì¶¤ì„ ìœ„í•´ 50% í™•ë¥ )
        if intent in self.context_post_templates and random.random() < 0.5:
            template = random.choice(self.context_post_templates[intent]['title'])
            return self.fill_template(template, keyword, topic), False
        
        # ì¹´í…Œê³ ë¦¬ ì„ íƒ
        if category is None:
            category = random.choice(['singlebunggle', 'emotion_double', 'thesingularity'])
        
        template = random.choice(self.title_templates[category])
        return self.fill_template(template, keyword, topic), False

    def classify_category(self, keyword):
        """í‚¤ì›Œë“œì˜ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜ (Tech, Life, Community, General)"""
        if not hasattr(self, 'categories'): return 'general'
        
        for cat, words in self.categories.items():
            if keyword in words:
                return cat
            # ë¶€ë¶„ ì¼ì¹˜ ì²´í¬ (ì˜ˆ: 'ìƒˆë²½ë°˜' -> 'ìƒˆë²½' í¬í•¨ -> life)
            for word in words:
                if word in keyword:
                    return cat
        return 'general'


def validate_eumseum(text):
    """ìŒìŠ´ì²´ ê²€ì¦ (ëª¨ë“  'ã…' ë°›ì¹¨ í™•ì¸, íŠ¹ìˆ˜ë¬¸ì ë¬´ì‹œ)"""
    if not text:
        return False
        
    sentences = text.strip().split('\n')
    last_sentence = sentences[-1].strip()
    
    if not last_sentence:
        return False
    
    # íŠ¹ìˆ˜ë¬¸ì, ê³µë°±, ã…‹ã…‹, ã…ã…, ; ë“± ì œê±° (í™•ì¥ë¨)
    cleaned = re.sub(r'[!?.ã…‹ã…\s~;,"\'()\-]+$', '', last_sentence)
    
    if not cleaned:
        return False
        
    last_char = cleaned[-1]
    
    # ê¸°ë³¸ í—ˆìš© ëª©ë¡ ('ìŒ', 'ìŠ´', 'ì„', 'í•¨', 'ë¨' ë“± ìì£¼ ì“°ì´ëŠ” ê²ƒ) + 'ë“¯'
    eumseum_endings = ['ìŒ', 'ìŠ´', 'ì„', 'í•¨', 'ë¨', 'ã…', 'ë‚¨', 'ë¦¼', 'ê¹€', 'ì§', 'ë“¯']
    if last_char in eumseum_endings:
        return True
        
    # ìœ ë‹ˆì½”ë“œ ê¸°ë°˜ 'ã…' ë°›ì¹¨ í™•ì¸ (í•œê¸€ ë²”ìœ„: AC00-D7A3)
    if 'ê°€' <= last_char <= 'í£':
        # (ìœ ë‹ˆì½”ë“œ - 0xAC00) % 28 == 16 ('ã…' ë°›ì¹¨ ì¸ë±ìŠ¤)
        if (ord(last_char) - 0xAC00) % 28 == 16:
            return True
            
    return False


if __name__ == "__main__":
    # í…ŒìŠ¤íŠ¸
    templates = MerseumTemplates()
    
    print("=== ì œëª© ìƒì„± í…ŒìŠ¤íŠ¸ ===")
    for i in range(10):
        print(f"{i+1}. {templates.generate_title()}")
    
    print("\\n=== ì‹±ê¸€ë²™ê¸€ì´Œ íŒ¨í„´ í…ŒìŠ¤íŠ¸ ===")
    for i in range(5):
        print(f"{i+1}. {templates.generate_title(category='singlebunggle')}")
    
    print("\\n=== ëŒ“ê¸€ í…ŒìŠ¤íŠ¸ ===")
    for i in range(5):
        comment = templates.generate_comment()
        print(f"{i+1}. {comment} (ìŒìŠ´ì²´: {validate_eumseum(comment)})")
    
    print("\\n=== ê²Œì‹œê¸€ ë‚´ìš© í…ŒìŠ¤íŠ¸ ===")
    content = templates.generate_content()
    print(content)
    print(f"\\nìŒìŠ´ì²´ ê²€ì¦: {validate_eumseum(content)}")
